import { ExportType } from './export-type';
import * as FileSaver from 'file-saver';
import { MAT_TABLE_EXPORTER, DOT, XLS_REGEX } from './constants';
var FileUtil = /** @class */ (function () {
    function FileUtil() {
    }
    FileUtil.save = function (content, mime, options) {
        var blob = new Blob([content], { type: mime.contentTypeHeader });
        var fileName = MAT_TABLE_EXPORTER;
        if (options && options.fileName) {
            fileName = options.fileName;
        }
        FileSaver.saveAs(blob, fileName + mime.extension);
    };
    FileUtil.isXls = function (fileName) {
        return fileName.toLowerCase().match(XLS_REGEX) != null;
    };
    FileUtil.identifyExportType = function (fileName) {
        if (fileName && FileUtil.isXls(fileName)) {
            return ExportType.XLS;
        }
        else {
            return ExportType.XLSX;
        }
    };
    FileUtil.removeExtension = function (options) {
        options.fileName = options.fileName.split(DOT)[0];
    };
    return FileUtil;
}());
export { FileUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS11dGlsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbWluaS1jZGstdGFibGUtZXhwb3J0ZXIvIiwic291cmNlcyI6WyJsaWIvZmlsZS11dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxLQUFLLFNBQVMsTUFBTSxZQUFZLENBQUM7QUFDeEMsT0FBTyxFQUFFLGtCQUFrQixFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFJakU7SUFBQTtJQXlCQSxDQUFDO0lBeEJlLGFBQUksR0FBbEIsVUFBbUIsT0FBZSxFQUFFLElBQVUsRUFBRSxPQUFpQjtRQUMvRCxJQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxpQkFBaUIsRUFBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxRQUFRLEdBQUcsa0JBQWtCLENBQUM7UUFDbEMsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLFFBQVEsRUFBRTtZQUMvQixRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztTQUM3QjtRQUNELFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVhLGNBQUssR0FBbkIsVUFBb0IsUUFBZ0I7UUFDbEMsT0FBTyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLElBQUksQ0FBQztJQUN6RCxDQUFDO0lBRWEsMkJBQWtCLEdBQWhDLFVBQWlDLFFBQWlCO1FBQ2hELElBQUksUUFBUSxJQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDeEMsT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDO1NBQ3ZCO2FBQU07WUFDTCxPQUFPLFVBQVUsQ0FBQyxJQUFJLENBQUM7U0FDeEI7SUFDSCxDQUFDO0lBRWEsd0JBQWUsR0FBN0IsVUFBOEIsT0FBaUI7UUFDN0MsT0FBTyxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBQ0gsZUFBQztBQUFELENBQUMsQUF6QkQsSUF5QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFeHBvcnRUeXBlIH0gZnJvbSAnLi9leHBvcnQtdHlwZSc7XG5pbXBvcnQgKiBhcyBGaWxlU2F2ZXIgZnJvbSAnZmlsZS1zYXZlcic7XG5pbXBvcnQgeyBNQVRfVEFCTEVfRVhQT1JURVIsIERPVCwgWExTX1JFR0VYIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgTWltZSB9IGZyb20gJy4vbWltZSc7XG5pbXBvcnQgeyBPcHRpb25zIH0gZnJvbSAnLi9vcHRpb25zJztcblxuZXhwb3J0IGNsYXNzIEZpbGVVdGlsIHtcbiAgcHVibGljIHN0YXRpYyBzYXZlKGNvbnRlbnQ6IHN0cmluZywgbWltZTogTWltZSwgb3B0aW9ucz86IE9wdGlvbnMpIHtcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7dHlwZTogbWltZS5jb250ZW50VHlwZUhlYWRlcn0pO1xuICAgIGxldCBmaWxlTmFtZSA9IE1BVF9UQUJMRV9FWFBPUlRFUjtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmZpbGVOYW1lKSB7XG4gICAgICBmaWxlTmFtZSA9IG9wdGlvbnMuZmlsZU5hbWU7XG4gICAgfVxuICAgIEZpbGVTYXZlci5zYXZlQXMoYmxvYiwgZmlsZU5hbWUgKyBtaW1lLmV4dGVuc2lvbik7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzWGxzKGZpbGVOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZmlsZU5hbWUudG9Mb3dlckNhc2UoKS5tYXRjaChYTFNfUkVHRVgpICE9IG51bGw7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlkZW50aWZ5RXhwb3J0VHlwZShmaWxlTmFtZT86IHN0cmluZyk6IEV4cG9ydFR5cGUge1xuICAgIGlmIChmaWxlTmFtZSAmJiBGaWxlVXRpbC5pc1hscyhmaWxlTmFtZSkpIHtcbiAgICAgIHJldHVybiBFeHBvcnRUeXBlLlhMUztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIEV4cG9ydFR5cGUuWExTWDtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHJlbW92ZUV4dGVuc2lvbihvcHRpb25zPzogT3B0aW9ucykge1xuICAgIG9wdGlvbnMuZmlsZU5hbWUgPSBvcHRpb25zLmZpbGVOYW1lLnNwbGl0KERPVClbMF07XG4gIH1cbn1cbiJdfQ==